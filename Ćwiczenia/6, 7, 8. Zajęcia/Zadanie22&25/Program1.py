from math import sqrt
import random


def random_list(length: int, min_num: int, max_num: int) -> list:
    return [random.randint(min_num, max_num) for _ in range(length)]


def prime_factors(n: int) -> list:
    factors = []
    if n < 4:
        return factors

    num_cp = n
    if not n % 2:
        n //= 2
        factors.append(2)
        while not n % 2:
            n //= 2

    div = 3
    while n > 1 and div <= int(sqrt(n)):
        if not n % div:
            factors.append(div)
            while not n % div:
                n //= div
        div += 2

    if n > 1 and n != num_cp:
        factors.append(n)

    return factors


def traverse(T) -> int:
    last_idx = len(T)-1
    visited = set()
    jumps = 0

    def recur(idx=0, jumps_count=0):
        for factor in prime_factors(T[idx]):
            new_idx = idx + factor
            if new_idx not in visited:
                if new_idx < last_idx:
                    visited.add(new_idx)
                    recur(new_idx, jumps_count+1)
                elif new_idx == last_idx:
                    nonlocal jumps
                    jumps = jumps_count+1
    recur()
    return jumps or -1


if __name__ == '__main__':
    random.seed(0)
    T = [258, 289, 845, 599, 894, 529, 147, 525, 16, 255, 291, 270, 877, 112, 983, 580, 565, 463, 735, 983, 23, 165, 733, 45, 889, 203, 422, 927, 146, 153, 147, 305, 862, 156, 508, 21, 663, 981, 50, 587, 997, 584, 444, 758, 826, 873, 253, 2, 600, 775, 303, 338, 174, 261, 684, 444, 297, 204, 756, 394, 149, 90, 721, 540, 175, 920, 105, 610, 630, 72, 616, 377, 522, 473, 868, 317, 960, 932, 843, 552, 70, 315, 336, 889, 376, 568, 623, 930, 623, 777, 527, 514, 393, 819, 449, 397, 531, 864, 408, 697, 233, 137, 15, 112, 51, 960, 609, 292, 916, 616, 734, 958, 690, 420, 750, 595, 675, 532, 426, 345, 874, 334, 43, 138, 266, 373, 547, 50, 344, 821, 957, 215, 792, 743, 337, 375, 268, 572, 966, 939, 176, 971, 257, 110, 814, 124, 13, 577, 301, 121, 937, 414, 887, 458, 192, 286, 580, 213, 168, 25, 547, 442, 993, 284, 237, 430, 881, 232, 997, 557, 843, 666, 796, 849, 953, 248, 214, 981, 151, 380, 32, 406, 966, 247, 644, 855, 926, 672, 822, 633, 74, 324, 492, 807, 489, 479, 334, 332, 161, 216, 279, 948, 920, 748, 781, 183, 556, 544, 148, 334, 282, 474, 192, 74, 419, 53, 493, 836, 146, 178, 780, 704, 551, 715, 866, 583, 217, 280, 736, 228, 636, 724, 363, 603, 460, 299, 978, 76, 318, 120, 537, 441, 729, 167, 381, 586, 29, 11, 938, 990, 204, 23, 244, 57, 689, 462, 564, 323, 132, 929, 445, 59, 911, 254, 550, 936, 320, 249, 824, 380, 494, 507, 165, 584, 297, 296, 737, 73, 734, 128, 42, 602, 420, 789, 993, 183, 914, 629, 134, 395, 632, 20, 596, 611, 767, 90, 607, 259, 935, 787, 881, 741, 826, 195, 433, 959, 998, 590, 550, 105, 621, 144, 509, 306, 271, 974, 909, 197, 562, 390, 813, 613, 609, 561, 612, 190, 154, 748, 629, 377, 451, 531, 84, 912, 928, 434, 853, 934, 176, 306, 835, 115, 52, 55, 571, 347, 486, 484, 37, 95, 169, 167, 629, 400, 997, 459, 124, 243, 118, 501, 272, 944, 375, 715, 502, 529, 396, 889, 287, 797, 549, 42, 254, 902, 609, 735, 262, 784, 387, 419, 412, 78, 209, 220, 65, 153, 254, 383, 403, 24, 39, 413, 291, 526, 298, 528, 342, 395, 156, 51, 927, 566, 479, 61, 72, 762, 507, 428, 443, 668, 120, 743, 325, 510, 376, 455, 448, 668, 867, 86, 709, 670, 737, 188, 750, 518, 461, 652, 115, 188, 917, 747, 705, 997, 145, 570, 13, 106, 717, 672, 109, 242, 294, 966, 355, 790, 927, 382, 809, 725, 609, 901, 457, 633, 688, 588, 995, 848, 117, 874, 106, 533, 395, 556, 993, 877, 349, 139, 744, 466, 990, 84, 396, 27, 853, 174, 518, 667, 427, 322, 933, 201, 324, 229, 175, 674, 102, 814, 569, 231, 585, 80, 628, 43, 174, 663, 489, 944, 821, 803, 745, 975, 143, 150, 978, 516, 757, 385, 26, 841, 99, 218, 469, 176, 323, 348, 696, 212, 619, 473, 869, 534, 82, 37, 297, 521, 596, 7, 989, 282, 567, 12, 106, 433, 859, 151, 230, 545, 910, 865, 105, 310, 424, 414, 941, 30, 396, 278, 388, 64, 428, 260, 615, 351, 163, 467, 561, 230, 378, 904, 20, 302, 336, 846, 73, 391, 988, 532, 935, 694, 550, 496, 299, 558, 671, 982, 760, 750, 35, 975, 71, 983, 808, 577, 673, 161, 209, 226, 191, 485, 567, 363, 295, 478, 999, 986, 122, 427, 787, 88, 247, 685, 556, 245, 561, 44, 105, 32, 216, 640, 107, 134, 577, 703, 21, 591, 410, 625, 904, 965, 188, 378, 970, 238, 279, 486, 129, 784, 543, 18, 380, 420, 554, 265, 411, 216, 631, 730, 702, 948, 229, 376, 794, 35, 800, 17, 770, 175, 763, 603, 606, 828, 123, 561, 527, 810, 742, 609, 474, 31, 296, 580, 775, 639, 348, 656, 745, 361, 93, 326, 864, 841, 187, 723, 12, 652, 746, 507, 694, 680, 370, 585, 11, 436, 389, 339, 160, 267, 303, 222, 564, 697, 895, 453, 858, 112, 782, 651, 138, 179, 661, 420, 679, 84, 819, 423, 461, 186, 368, 489, 601, 51, 823, 974, 973, 139, 931, 818, 990, 438, 836, 550, 428, 234, 660, 101, 916, 959, 101, 80, 898, 836, 336, 317, 482, 460, 739, 595, 3, 597, 581, 694, 893, 598, 954, 50, 447, 778, 371, 145, 408, 574, 440, 118, 724, 677, 386, 169, 498, 296, 96, 40, 825, 634, 485, 733, 475, 834, 229, 350, 846, 363, 366, 14, 523, 224, 42, 893, 777, 837, 708, 320, 75, 884, 697, 561, 595, 581, 503, 653, 738, 303, 653, 161, 462, 962, 299, 61, 688, 551, 704, 79, 899, 126, 367, 517, 340, 135, 905, 491, 768, 454, 171, 991, 476, 862, 803, 839, 783, 435, 751, 445, 320, 449, 72, 293, 321, 896, 687, 774, 435, 672, 947, 72, 869, 476, 671, 533, 289, 368, 22, 222, 251, 961, 692, 917, 532, 751, 738, 135, 837, 135, 503, 40, 980, 98, 633, 330, 713, 396, 308, 245, 996, 357, 660, 847, 797, 227, 213, 63, 279, 612, 636, 309, 244, 881, 107, 6, 560, 792, 779, 144, 999, 903, 124, 749, 244, 403, 708, 186, 323, 713, 839, 337, 509, 162, 903, 944, 833, 26, 871, 204, 670, 357, 536, 711, 115, 550, 514, 172, 890, 250, 171, 149, 686, 890, 932, 880, 426, 788, 715, 789, 165, 327, 221, 295, 51, 580, 551, 288, 810, 448, 824, 848, 967, 599, 384, 541, 494, 500, 396, 72, 681, 615, 763, 930, 122, 116, 407, 900, 454, 544, 779, 939, 87, 663, 914, 391, 948, 332, 749, 752, 684, 991, 600, 534, 631, 417, 423, 160, 864, 516, 762, 873, 586, 671, 207, 247, 3, 374, 118, 388, 81, 325, 411, 109, 709, 237, 985, 753, 214, 3, 794, 754, 900, 61, 723, 819, 55, 597]
    print(T)
    print(traverse(T))

'''
[2, 2, 2, 2, 2, 2, 2, 2, 2]
[14, 14, 25, 16, 7, 24, 15, 17]
'''
